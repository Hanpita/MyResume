<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF在线预览（兼容所有浏览器）</title>
    <!-- 更换为 Cloudflare 稳定 CDN 源（解决404问题） -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.8.69/pdf.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.8.69/pdf_viewer.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f5f5f5; min-height: 100vh; }
        .pdf-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .loading { text-align: center; padding: 50px 0; color: #666; font-size: 16px; }
        .error { text-align: center; padding: 50px; color: #ff4d4f; font-size: 16px; }
        .error a { color: #1890ff; text-decoration: none; }
    </style>
</head>
<body>
    <div class="pdf-container">
        <div class="loading">PDF加载中... 请稍候</div>
        <div id="pdfViewer" class="pdfViewer" style="display: none;"></div>
        <div id="error" class="error" style="display: none;"></div>
    </div>

    <script>
        // 同级目录的PDF文件（相对路径）
        const pdfUrl = "PeishiHan_UXUI_Resume.pdf";
        
        // 修正PDF.js引用路径（Cloudflare CDN对应的worker路径）
        const pdfjsLib = window['pdfjsLib']; // 直接使用全局变量，避免路径错误
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.8.69/pdf.worker.min.js';

        async function renderPdf() {
            try {
                const pdfDoc = await pdfjsLib.getDocument({
                    url: pdfUrl,
                    cMapPacked: true,
                    cMapUrl: 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.8.69/cmaps/', // 同步更换CDN源
                    rangeChunkSize: 65536,
                    withCredentials: false
                }).promise;

                document.querySelector('.loading').style.display = 'none';
                document.getElementById('pdfViewer').style.display = 'block';

                const container = document.getElementById('pdfViewer');
                const viewer = new pdfjsLib.PDFViewer({
                    container: container,
                    scale: 1.2,
                    showPageLabels: true,
                    showZoomButtons: true,
                    showDownloadButton: true,
                    showPrintButton: true,
                    showBookmarkButton: true
                });

                viewer.setDocument(pdfDoc);

                window.addEventListener('resize', () => {
                    viewer.currentScaleValue = 'page-fit';
                });

            } catch (error) {
                document.querySelector('.loading').style.display = 'none';
                const errorEl = document.getElementById('error');
                errorEl.style.display = 'block';
                errorEl.innerHTML = `
                    PDF加载失败，请尝试：<br>
                    1. <a href="${pdfUrl}" target="_blank">直接下载查看</a><br>
                    2. 刷新页面重试（Ctrl+Shift+R）
                `;
                console.error('PDF加载错误：', error);
            }
        }

        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            renderPdf();
        } else {
            document.addEventListener('DOMContentLoaded', renderPdf);
        }
    </script>
</body>
</html>
